<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Deutsche Fahrschul-App</title>
    
    <!-- iOS Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Fahrschule">
    <meta name="theme-color" content="#1E40AF">
    
    <!-- Capacitor -->
    <script type="module" src="capacitor.js"></script>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            -webkit-overflow-scrolling: touch;
            overflow-x: hidden;
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
            padding-left: env(safe-area-inset-left);
            padding-right: env(safe-area-inset-right);
        }
        
        .touch-button {
            min-height: 44px;
            min-width: 44px;
            touch-action: manipulation;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        .touch-button:active {
            transform: scale(0.95);
        }
        
        .student-card {
            transition: transform 0.2s ease;
        }
        
        .student-card:active {
            transform: scale(0.98);
        }
        
        /* Smooth animations */
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Progress bars */
        .progress-bar {
            transition: width 0.5s ease;
        }
        
        /* Training section colors - exakt wie Backend */
        .grundstufe { background: linear-gradient(135deg, #FEF3C7, #F59E0B); }
        .aufbaustufe { background: linear-gradient(135deg, #FED7AA, #F97316); }
        .leistungsstufe { background: linear-gradient(135deg, #FCA5A5, #EF4444); }
        .grundfahraufgaben { background: linear-gradient(135deg, #FEF3C7, #F59E0B); }
        .uberlandfahrten { background: linear-gradient(135deg, #FEF08A, #FDE047); }
        .autobahn { background: linear-gradient(135deg, #FEF08A, #FDE047); }
        .dammerung_dunkelheit { background: linear-gradient(135deg, #FEF08A, #FDE047); }
        .reife_teststufe { background: linear-gradient(135deg, #A7F3D0, #10B981); }
        .situative_bausteine { background: linear-gradient(135deg, #BFDBFE, #60A5FA); }
        .fahrerassistenzsysteme { background: linear-gradient(135deg, #BFDBFE, #60A5FA); }
        .beim_fahrer { background: linear-gradient(135deg, #BFDBFE, #60A5FA); }
        .heizung_luftung { background: linear-gradient(135deg, #BFDBFE, #60A5FA); }
        .betriebs_verkehrssicherheit { background: linear-gradient(135deg, #BFDBFE, #60A5FA); }
        .witterung { background: linear-gradient(135deg, #BFDBFE, #60A5FA); }
        
        /* Progress indicators */
        .progress-checkbox {
            transition: all 0.2s ease;
        }
        
        .progress-checkbox:hover {
            transform: scale(1.1);
        }
        
        .progress-once { background-color: #fef3c7; color: #f59e0b; }
        .progress-twice { background-color: #ddd6fe; color: #8b5cf6; }
        .progress-thrice { background-color: #dcfce7; color: #16a34a; }
        
        /* Safe area handling for iOS */
        .safe-top { padding-top: env(safe-area-inset-top); }
        .safe-bottom { padding-bottom: env(safe-area-inset-bottom); }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div id="app" class="min-h-screen">
        <!-- Loading Screen -->
        <div id="loading" class="fixed inset-0 bg-gray-50 flex items-center justify-center z-50">
            <div class="text-center">
                <div class="animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"></div>
                <p class="text-gray-600 text-lg font-medium">Deutsche Fahrschul-App wird geladen...</p>
                <p class="text-gray-500 text-sm mt-2">Native iOS-App mit komplettem Ausbildungsbaum</p>
            </div>
        </div>
        
        <!-- Main Content -->
        <div id="main-content" style="display: none;">
            <!-- Content wird hier eingefÃ¼gt -->
        </div>
    </div>
    
    <script>
        // ==================== CAPACITOR INTEGRATION ====================
        
        let CapacitorPreferences = null;
        
        // Initialize Capacitor
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const { Capacitor } = await import('./capacitor.js');
                if (Capacitor.isNativePlatform()) {
                    const { Preferences } = await import('@capacitor/preferences');
                    CapacitorPreferences = Preferences;
                    console.log('ğŸš€ Capacitor native platform detected');
                }
            } catch (error) {
                console.log('ğŸ“± Running in web mode');
            }
            
            initApp();
        });
        
        // ==================== DATA MODELS ====================
        
        // Demo-Daten (Original aus der Preview)
        const DEMO_STUDENTS = [
            {
                id: 'anna-schmidt-001',
                name: 'Anna',
                surname: 'Schmidt',
                date_of_birth: '1998-03-20',
                address: 'MusterstraÃŸe 123, 12345 Berlin',
                phone: '+49 123 456789',
                start_date: '2024-01-15',
                theory_exam_date: '2025-10-15',
                practical_exam_date: '2025-11-20',
                theory_exam_passed: false,
                practical_exam_passed: false,
                wears_glasses: true,
                ueberlandfahrten: [true, true, false, true, false],
                autobahnfahrten: [true, false, true, false, true],
                nachtfahrten: [false, true, false],
                uebungsfahrten_ganz: [true, true, false, true, false, false, true, false, true, true],
                uebungsfahrten_halb: [true, false, true, false, true],
                created_at: '2024-01-15T10:00:00Z',
                updated_at: new Date().toISOString()
            },
            {
                id: 'daniel-daft-002',
                name: 'Daniel',
                surname: 'Daft',
                date_of_birth: '1995-07-12',
                address: 'Beispielweg 456, 54321 Hamburg',
                phone: '+49 987 654321',
                start_date: '2024-02-01',
                theory_exam_date: '2025-09-20',
                practical_exam_date: '2025-10-25',
                theory_exam_passed: true,
                practical_exam_passed: false,
                wears_glasses: false,
                ueberlandfahrten: [true, false, true, false, true],
                autobahnfahrten: [false, true, true, false],
                nachtfahrten: [true, false, true],
                uebungsfahrten_ganz: [true, true, true, false, true, false, true],
                uebungsfahrten_halb: [false, true, true, false],
                created_at: '2024-02-01T09:30:00Z',
                updated_at: new Date().toISOString()
            },
            {
                id: 'test-schueler-003',
                name: 'Test',
                surname: 'SchÃ¼ler',
                date_of_birth: '2000-12-05',
                address: 'TeststraÃŸe 789, 98765 MÃ¼nchen',
                phone: '+49 555 123456',
                start_date: '2024-03-10',
                theory_exam_passed: false,
                practical_exam_passed: false,
                wears_glasses: null,
                ueberlandfahrten: [false, false, false, false, false],
                autobahnfahrten: [false, false, false, false],
                nachtfahrten: [false, false, false],
                uebungsfahrten_ganz: [true, false, false],
                uebungsfahrten_halb: [false, true],
                created_at: '2024-03-10T14:15:00Z',
                updated_at: new Date().toISOString()
            }
        ];

        // Training Categories (VOLLSTÃ„NDIG aus Backend - 1:1 Copy)
        const TRAINING_CATEGORIES = {
            "grundstufe": {
                "name": "Grundstufe",
                "subtitle": "Einweisung und Bedienung",
                "color": "#F59E0B",
                "sections": {
                    "besonderheiten_einsteigen": {
                        "name": "Besonderheiten beim Einsteigen",
                        "items": ["Besonderheiten beim Einsteigen"]
                    },
                    "einstellen": {
                        "name": "Einstellen", 
                        "items": ["Sitz", "Spiegel", "Lenkrad", "KopfstÃ¼tze"]
                    },
                    "lenkradhaltung": {
                        "name": "Lenkradhaltung",
                        "items": ["Lenkradhaltung"]
                    },
                    "pedale": {
                        "name": "Pedale",
                        "items": ["Pedale"]
                    },
                    "gurt_anlegen": {
                        "name": "Gurt anlegen/anpassen",
                        "items": ["Gurt anlegen/anpassen"]
                    },
                    "schalt_wahlhebel": {
                        "name": "Schalt-/WÃ¤hlhebel",
                        "items": ["Schalt-/WÃ¤hlhebel"]
                    },
                    "zundschloss": {
                        "name": "ZÃ¼ndschloss",
                        "items": ["ZÃ¼ndschloss"]
                    },
                    "motor_anlassen": {
                        "name": "Motor anlassen",
                        "items": ["Motor anlassen"]
                    },
                    "anfahren": {
                        "name": "Anfahren/AnhalteÃ¼bungen",
                        "items": ["Anfahren/AnhalteÃ¼bungen"]
                    },
                    "schaltubungen": {
                        "name": "SchaltÃ¼bungen (umweltschonend)",
                        "items": ["hoch: 1-2", "2-3", "3-4", "...", "runter: 4-3", "3-2", "2-1", "...", "runter: 4-2", "4-1", "3-1"]
                    },
                    "lenkubungen": {
                        "name": "LenkÃ¼bungen",
                        "items": ["LenkÃ¼bungen"]
                    }
                }
            },
            "aufbaustufe": {
                "name": "Aufbaustufe", 
                "subtitle": "Umweltschonendes, vorausschauendes Fahren, Blickschulung",
                "color": "#F97316",
                "sections": {
                    "rollen_schalten": {
                        "name": "Rollen und Schalten",
                        "items": ["Rollen und Schalten"]
                    },
                    "abbremsen_schalten": {
                        "name": "Abbremsen und Schalten",
                        "items": ["Abbremsen und Schalten"]
                    },
                    "bremsÃ¼bungen": {
                        "name": "BremsÃ¼bungen",
                        "items": ["degressiv", "Zielbremsungen", "Gefahrsituationen"]
                    },
                    "gefalle": {
                        "name": "GefÃ¤lle",
                        "items": ["Anhalten", "Anfahren", "RÃ¼ckwÃ¤rts", "Sichern", "Schalten"]
                    },
                    "steigung": {
                        "name": "Steigung", 
                        "items": ["Anhalten", "Anfahren", "RÃ¼ckwÃ¤rts", "Sichern", "Schalten"]
                    },
                    "tastgeschwindigkeit": {
                        "name": "Tastgeschwindigkeit",
                        "items": ["Tastgeschwindigkeit"]
                    },
                    "bedienungs_kontrolleinrichtungen": {
                        "name": "Bedienungs- und Kontrolleinrichtungen",
                        "items": ["Bedienungs- und Kontrolleinrichtungen"]
                    },
                    "ortliche_besonderheiten": {
                        "name": "Ã–rtliche Besonderheiten",
                        "items": ["Ã–rtliche Besonderheiten"]
                    }
                }
            },
            "leistungsstufe": {
                "name": "Leistungsstufe",
                "subtitle": "Schwierige Verkehrssituationen, umweltschonendes, vorausschauendes Fahren, Blickschulung/Bremsbereitschaft",
                "color": "#EF4444", 
                "sections": {
                    "fahrbahnabutzung": {
                        "name": "Fahrbahnbenutzung",
                        "items": ["Einordnen", "Markierungen"]
                    },
                    "fahrstreifenwechsel": {
                        "name": "Fahrstreifenwechsel",
                        "items": ["links", "rechts"]
                    },
                    "vorbeifahren": {
                        "name": "Vorbeifahren/Ãœberholen",
                        "items": ["Vorbeifahren/Ãœberholen"]
                    },
                    "abbiegen": {
                        "name": "Abbiegen",
                        "items": ["rechts", "links", "mehrspurig", "Radweg", "Sonderstreifen", "StraÃŸenbahnen", "EinbahnstraÃŸen"]
                    },
                    "vorfahrt": {
                        "name": "Vorfahrt",
                        "items": ["rechts vor links", "GrÃ¼npfeil", "Polizeibeamte", "GrÃ¼npfeil-Schild"]
                    },
                    "geschwindigkeit_abstand": {
                        "name": "Geschwindigkeit/Abstand",
                        "items": ["Geschwindigkeit/Abstand"]
                    },
                    "situationen_verkehrsteilnehmer": {
                        "name": "Situationen mit anderen Verkehrsteilnehmern",
                        "items": ["FuÃŸgÃ¤ngerÃ¼berwege", "Kinder", "Ã–ffentl. Verkehrsmittel", "Schulbus", "Ã„ltere/Behinderte", "Radfahrer/Mofa", "Einbahnstr./Radfahrer", "Verk.-beruh. Bereich"]
                    },
                    "schwierige_verkehrsfuhrung": {
                        "name": "Schwierige VerkehrsfÃ¼hrung",
                        "items": ["Schwierige VerkehrsfÃ¼hrung"]
                    },
                    "engpass": {
                        "name": "Engpass",
                        "items": ["Engpass"]
                    },
                    "kreisverkehr": {
                        "name": "Kreisverkehr",
                        "items": ["Kreisverkehr"]
                    },
                    "bahnubergang": {
                        "name": "BahnÃ¼bergang (warten)",
                        "items": ["BahnÃ¼bergang (warten)"]
                    },
                    "kritische_verkehrssituationen": {
                        "name": "Kritische Verkehrssituationen",
                        "items": ["Hauptverkehrszeiten", "Partnerschaftliches Verhalten (Kommunikation, Verzicht auf Vorfahrt)", "Schwung nutzen"]
                    },
                    "fussganger_schutzbereich": {
                        "name": "FuÃŸgÃ¤nger Schutzbereich",
                        "items": ["FuÃŸgÃ¤nger Schutzbereich"]
                    }
                }
            },
            "grundfahraufgaben": {
                "name": "Grundfahraufgaben",
                "color": "#F59E0B",
                "sections": {
                    "ruckwartsfahren": {
                        "name": "RÃ¼ckwÃ¤rtsfahren",
                        "items": ["RÃ¼ckwÃ¤rtsfahren"]
                    },
                    "umkehren": {
                        "name": "Umkehren", 
                        "items": ["Umkehren"]
                    },
                    "gefahrbremsung": {
                        "name": "Gefahrbremsung",
                        "items": ["Gefahrbremsung"]
                    },
                    "einparken_langs": {
                        "name": "Einparken lÃ¤ngs",
                        "items": ["vorwÃ¤rts rechts", "vorwÃ¤rts links", "rÃ¼ckwÃ¤rts rechts", "rÃ¼ckwÃ¤rts links"]
                    },
                    "einparken_quer": {
                        "name": "Einparken quer", 
                        "items": ["vorwÃ¤rts rechts", "vorwÃ¤rts links", "rÃ¼ckwÃ¤rts rechts", "rÃ¼ckwÃ¤rts links"]
                    }
                }
            },
            "uberlandfahrten": {
                "name": "Ãœberlandfahrten",
                "subtitle": "Sicheres und umweltschonendes Fahren mit hÃ¶heren Geschwindigkeiten auf LandstraÃŸen",
                "color": "#FDE047",
                "sections": {
                    "main_items": {
                        "name": "",
                        "items": [
                            "Angepasste Geschwindigkeit/Gangwahl (alle GÃ¤nge)"
                        ]
                    },
                    "abstand": {
                        "name": "Abstand",
                        "items": ["vorne", "hinten", "seitlich"]
                    },
                    "main_items_2": {
                        "name": "",
                        "items": [
                            "Beobachtung/Spiegel",
                            "Verkehrszeichen",
                            "Kreuzungen/EinmÃ¼ndungen", 
                            "Kurven",
                            "Steigungen",
                            "GefÃ¤lle",
                            "Alleen",
                            "Ãœberholen"
                        ]
                    },
                    "besondere_situationen": {
                        "name": "Besondere Situationen",
                        "items": ["Liegenbleiben â€¢ Absichern", "Einfahren in Ortschaften", "FuÃŸgÃ¤nger", "Wild/Tiere"]
                    },
                    "besondere_anforderungen": {
                        "name": "Besondere Anforderungen",
                        "items": ["Leistungsgrenze", "Ablenkung", "Konfliktsituationen"]
                    }
                }
            },
            "autobahn": {
                "name": "Autobahn",
                "subtitle": "Sicheres und umweltschonendes Fahren mit hÃ¶heren Geschwindigkeiten auf Autobahnen",
                "color": "#FDE047",
                "sections": {
                    "main_items_1": {
                        "name": "",
                        "items": [
                            "Fahrtplanung",
                            "Einfahren in BAB",
                            "Fahrstreifenwahl", 
                            "Geschwindigkeit"
                        ]
                    },
                    "abstand": {
                        "name": "Abstand",
                        "items": ["vorne", "hinten", "seitlich"]
                    },
                    "main_items_2": {
                        "name": "",
                        "items": [
                            "Ãœberholen",
                            "Schilder/Markierungen",
                            "Vorbeifahren/Anschlussstellen",
                            "Rast-/ParkplÃ¤tze, Tankstellen",
                            "Verhalten bei UnfÃ¤llen",
                            "Dichter Verkehr/Stau",
                            "Besondere Situationen"
                        ]
                    },
                    "besondere_anforderungen": {
                        "name": "Besondere Anforderungen",
                        "items": ["Leistungsgrenze", "Ablenkung", "Konfliktsituationen"]
                    },
                    "final_items": {
                        "name": "",
                        "items": ["Verlassen der BAB"]
                    }
                }
            },
            "dammerung_dunkelheit": {
                "name": "DÃ¤mmerung/Dunkelheit", 
                "subtitle": "Kontrollieren/Einschalten der Beleuchtungseinrichtungen",
                "color": "#FDE047",
                "sections": {
                    "beleuchtung": {
                        "name": "Beleuchtung",
                        "items": ["Kontrolle", "Benutzung", "Einstellen", "Fernlicht"]
                    },
                    "main_items": {
                        "name": "",
                        "items": [
                            "Beleuchtete StraÃŸen",
                            "Unbeleuchtete StraÃŸen", 
                            "Parken"
                        ]
                    },
                    "besondere_situationen": {
                        "name": "Besondere Situationen",
                        "items": ["Schlechte Witterung", "BahnÃ¼bergÃ¤nge", "Tiere", "Unbeleuchtete Verkehrsteilnehmer"]
                    },
                    "besondere_anforderungen": {
                        "name": "Besondere Anforderungen",
                        "items": ["Blendung", "Orientierung"]
                    },
                    "final_items": {
                        "name": "",
                        "items": ["Abschlussbesprechung"]
                    }
                }
            },
            "reife_teststufe": {
                "name": "Reife- und Teststufe",
                "subtitle": "Abschluss der Ausbildung - PrÃ¼fungsvorbereitung",
                "color": "#10B981",
                "sections": {
                    "selbststandiges_fahren": {
                        "name": "SelbststÃ¤ndiges Fahren",
                        "items": ["innerorts", "auÃŸerorts"]
                    },
                    "verantwortungsbewusstes_fahren": {
                        "name": "Verantwortungsbewusstes Fahren",
                        "items": ["Verantwortungsbewusstes Fahren"]
                    },
                    "testfahrt": {
                        "name": "Testfahrt unter PrÃ¼fungsbedingungen",
                        "items": ["FAKT", "andere"]
                    },
                    "wiederholung": {
                        "name": "Wiederholung/Vertiefung",
                        "items": ["Wiederholung/Vertiefung"]
                    },
                    "leistungsbewertung": {
                        "name": "Leistungsbewertung", 
                        "items": ["Leistungsbewertung"]
                    }
                }
            },
            "situative_bausteine": {
                "name": "Situative Bausteine",
                "color": "#60A5FA",
                "sections": {
                    "fahrtechnische_vorbereitung": {
                        "name": "Checkliste zur fahrtechnischen Vorbereitung",
                        "sections": {
                            "fahrzeug": {
                                "name": "Beim Fahrzeug",
                                "items": ["Reifen (z.B. BeschÃ¤digungen, Profiltiefe, Reifendruck)"]
                            },
                            "scheiben_leuchten": {
                                "name": "Scheiben, Leuchten, Blinker, Hupe",
                                "items": ["Ein- und Ausschalten"]
                            },
                            "funktion_prufen": {
                                "name": "Funktion prÃ¼fen",
                                "items": ["Standlicht", "Abblendlicht", "Fernlicht", "Schlussleucht m. Kennzeichenbeleuchtung", "Nebelschlussleuchte", "Warnblinkanlage", "Blinker", "Hupe", "Bremsleuchte"]
                            },
                            "kontrollleuchten": {
                                "name": "Kontrollleuchten benennen",
                                "items": ["Kontrollleuchten benennen"]
                            },
                            "ruckstrahler": {
                                "name": "RÃ¼ckstrahler",
                                "items": ["Vorhandensein", "BeschÃ¤digung"]
                            },
                            "lenkung": {
                                "name": "Lenkung",
                                "items": ["Lenkschloss entriegeln", "ÃœberprÃ¼fen des Lenkspiels"]
                            },
                            "bremsen": {
                                "name": "FunktionsprÃ¼fung der Bremsen",
                                "items": ["Betriebsbremse", "Feststellbremse"]
                            }
                        }
                    }
                }
            },
            "fahrerassistenzsysteme": {
                "name": "Fahrerassistenzsysteme",
                "color": "#60A5FA",
                "sections": {
                    "bedienung": {
                        "name": "Bedienung der Fahrerassistenzsysteme",
                        "items": ["Bedienung der Fahrerassistenzsysteme"]
                    }
                }
            },
            "beim_fahrer": {
                "name": "Beim Fahrer (vor Fahrtbeginn)",
                "subtitle": "Richtige Sitzeinstellung",
                "color": "#60A5FA",
                "sections": {
                    "sitzeinstellung": {
                        "name": "Richtige Sitzeinstellung",
                        "items": ["Richtige Sitzeinstellung"]
                    },
                    "ruckspiegeleinstellung": {
                        "name": "Einstellung der RÃ¼ckspiegel",
                        "items": ["der KopfstÃ¼tze", "des Lenkrades"]
                    },
                    "sicherheitsgurt": {
                        "name": "Anlegen des Sicherheitsgurtes",
                        "items": ["Anlegen des Sicherheitsgurtes"]
                    }
                }
            },
            "heizung_luftung": {
                "name": "Heizung und LÃ¼ftung",
                "color": "#60A5FA",
                "sections": {
                    "bedienen_aggregate": {
                        "name": "Bedienen der Aggregate",
                        "items": ["Heizung", "LÃ¼ftung", "Klimaanlage", "Heckscheibenheizung", "Beheizte Sonderausstattungen"]
                    },
                    "energiesparende_nutzung": {
                        "name": "Energiesparende Nutzung",
                        "items": ["keine unnÃ¶tigen Verbraucher", "Rechtzeitiges Abschalten"]
                    }
                }
            },
            "betriebs_verkehrssicherheit": {
                "name": "Betriebs- und Verkehrssicherheit",
                "color": "#60A5FA",
                "sections": {
                    "motorraum": {
                        "name": "Motorraum/FlÃ¼ssigkeitsstÃ¤nde",
                        "items": ["MotorÃ¶l", "KÃ¼hlmittel", "ScheibenwischflÃ¼ssigkeit"]
                    },
                    "tanken": {
                        "name": "Tanken",
                        "items": ["Tanken"]
                    },
                    "sicherungsmittel": {
                        "name": "Sicherungsmittel",
                        "items": ["Warndreieck", "Verbandskasten", "Bordwerkzeug", "zusÃ¤tzliche AusrÃ¼stung"]
                    },
                    "aussenkontrolle": {
                        "name": "AuÃŸenkontrolle (SchÃ¤den, Sauberkeit)",
                        "items": ["Scheiben/Wischer", "Spiegel", "Kennzeichen(HU/AU)", "Beleuchtung"]
                    },
                    "bremsen": {
                        "name": "Bremsen",
                        "items": ["Bremsen"]
                    },
                    "ladung": {
                        "name": "Ladung",
                        "items": ["Sicherung", "Kennzeichnung"]
                    }
                }
            },
            "witterung": {
                "name": "Witterung",
                "subtitle": "Fahren bei verschiedenen Witterungsbedingungen",
                "color": "#60A5FA",
                "sections": {
                    "schlechte_witterung": {
                        "name": "Fahren bei schlechter Witterung",
                        "items": ["LÃ¼ftung", "Beleuchtung", "Scheibenwischer/-washer", "Regen, SprÃ¼hnebel", "Wasserlachen, Aquaplaning", "Wind, Sturm, BÃ¶en", "Schnee und Matsch", "Eis"]
                    }
                }
            }
        };

        // ==================== STORAGE MANAGER (Capacitor + Fallback) ====================
        
        const STORAGE_KEYS = {
            STUDENTS: 'fahrschul_students_native',
            PROGRESS: 'fahrschul_progress_native',
            SETTINGS: 'fahrschul_settings_native'
        };

        const StorageManager = {
            // Get data with Capacitor/localStorage fallback
            async getData(key) {
                try {
                    if (CapacitorPreferences) {
                        const result = await CapacitorPreferences.get({ key });
                        return result.value ? JSON.parse(result.value) : null;
                    } else {
                        const stored = localStorage.getItem(key);
                        return stored ? JSON.parse(stored) : null;
                    }
                } catch (error) {
                    console.error('Error getting data:', error);
                    return null;
                }
            },
            
            // Set data with Capacitor/localStorage fallback
            async setData(key, value) {
                try {
                    const jsonValue = JSON.stringify(value);
                    if (CapacitorPreferences) {
                        await CapacitorPreferences.set({ key, value: jsonValue });
                    } else {
                        localStorage.setItem(key, jsonValue);
                    }
                } catch (error) {
                    console.error('Error setting data:', error);
                }
            },
            
            // Students
            async getStudents() {
                const students = await this.getData(STORAGE_KEYS.STUDENTS);
                return students || [];
            },
            
            async saveStudents(students) {
                await this.setData(STORAGE_KEYS.STUDENTS, students);
            },
            
            async getStudentById(id) {
                const students = await this.getStudents();
                return students.find(s => s.id === id);
            },
            
            async updateStudent(updatedStudent) {
                const students = await this.getStudents();
                const index = students.findIndex(s => s.id === updatedStudent.id);
                if (index >= 0) {
                    students[index] = { ...updatedStudent, updated_at: new Date().toISOString() };
                    await this.saveStudents(students);
                    return students[index];
                }
                return null;
            },
            
            // Progress (mit gewichteter Berechnung)
            async getProgressForStudent(studentId) {
                const allProgress = await this.getData(STORAGE_KEYS.PROGRESS);
                return (allProgress && allProgress[studentId]) || {};
            },
            
            async saveProgressForStudent(studentId, progress) {
                const allProgress = await this.getData(STORAGE_KEYS.PROGRESS);
                const updatedProgress = allProgress || {};
                updatedProgress[studentId] = progress;
                await this.setData(STORAGE_KEYS.PROGRESS, updatedProgress);
            },
            
            async updateProgressItem(studentId, categoryKey, sectionKey, itemKey, status) {
                const progress = await this.getProgressForStudent(studentId);
                if (!progress[categoryKey]) progress[categoryKey] = {};
                if (!progress[categoryKey][sectionKey]) progress[categoryKey][sectionKey] = {};
                progress[categoryKey][sectionKey][itemKey] = status;
                await this.saveProgressForStudent(studentId, progress);
            },
            
            // Initialize with demo data
            async initDemoData() {
                const students = await this.getStudents();
                if (students.length === 0) {
                    await this.saveStudents(DEMO_STUDENTS);
                }
            }
        };

        // ==================== UTILITY FUNCTIONS ====================
        
        // Deutsche Datumsformatierung
        function formatGermanDate(dateString) {
            if (!dateString) return '';
            const date = new Date(dateString);
            return date.toLocaleDateString('de-DE', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            });
        }

        // Progress Berechnung (mit gewichteten Werten)
        function calculateOverallProgress(student) {
            const fahrten = [
                ...(student.ueberlandfahrten || []),
                ...(student.autobahnfahrten || []),
                ...(student.nachtfahrten || []),
                ...(student.uebungsfahrten_ganz || []),
                ...(student.uebungsfahrten_halb || [])
            ];
            
            const completed = fahrten.filter(Boolean).length;
            const total = fahrten.length;
            
            return total > 0 ? Math.round((completed / total) * 100) : 0;
        }

        function getProgressColor(percentage) {
            if (percentage >= 90) return 'text-green-500';
            if (percentage >= 70) return 'text-yellow-500';
            if (percentage >= 40) return 'text-orange-500';
            return 'text-red-500';
        }

        // Gesamtanzahl Items rekursiv zÃ¤hlen
        function countTotalItems(sections) {
            let total = 0;
            Object.values(sections).forEach(section => {
                if (section.sections) {
                    total += countTotalItems(section.sections);
                } else if (section.items) {
                    total += section.items.length;
                }
            });
            return total;
        }

        // Progress Status Cycling (not_started -> once -> twice -> thrice -> not_started)
        function getNextStatus(currentStatus) {
            const statusCycle = ['not_started', 'once', 'twice', 'thrice'];
            const currentIndex = statusCycle.indexOf(currentStatus || 'not_started');
            return statusCycle[(currentIndex + 1) % statusCycle.length];
        }

        function getStatusSymbol(status) {
            switch(status) {
                case 'once': return '/';
                case 'twice': return 'Ã—';
                case 'thrice': return 'âŠ—';
                default: return '';
            }
        }

        function getStatusClass(status) {
            switch(status) {
                case 'once': return 'progress-once';
                case 'twice': return 'progress-twice';
                case 'thrice': return 'progress-thrice';
                default: return 'bg-gray-100';
            }
        }

        // ==================== MAIN APPLICATION ====================
        
        let currentView = 'list'; // 'list', 'detail'
        let selectedStudent = null;

        // Student List rendern
        async function renderStudentList() {
            const students = await StorageManager.getStudents();
            
            let html = `
                <div class="p-4 fade-in safe-top">
                    <!-- Header -->
                    <div class="flex items-center justify-between mb-6 bg-white rounded-lg shadow-sm p-4">
                        <div>
                            <h1 class="text-2xl font-bold text-gray-800">ğŸš— Deutsche Fahrschul-App</h1>
                            <p class="text-gray-600">Native iOS-App mit komplettem Ausbildungsbaum</p>
                        </div>
                        <button onclick="showAlert('Neuer SchÃ¼ler - Feature kommt bald!')" class="touch-button bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                            + Neu
                        </button>
                    </div>

                    <!-- Student Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            `;
            
            students.forEach(student => {
                const progress = calculateOverallProgress(student);
                const colorClass = getProgressColor(progress);
                
                html += `
                    <div class="student-card bg-white rounded-xl shadow-sm p-4 cursor-pointer touch-button" onclick="openStudentDetail('${student.id}')">
                        <div class="flex items-center justify-between mb-3">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                                    ğŸ‘¤
                                </div>
                                <div>
                                    <h3 class="font-semibold text-gray-800">${student.name} ${student.surname}</h3>
                                    <p class="text-sm text-gray-600">Seit ${formatGermanDate(student.start_date)}</p>
                                </div>
                            </div>
                            <div class="text-center">
                                <div class="text-xl font-bold ${colorClass}">${progress}%</div>
                                <div class="text-xs text-gray-500">Fortschritt</div>
                            </div>
                        </div>
                        
                        <!-- Progress Bar -->
                        <div class="w-full bg-gray-200 rounded-full h-2 mb-3">
                            <div class="progress-bar ${progress >= 90 ? 'bg-green-500' : progress >= 70 ? 'bg-yellow-500' : progress >= 40 ? 'bg-orange-500' : 'bg-red-500'} h-2 rounded-full" style="width: ${progress}%"></div>
                        </div>
                        
                        <!-- Quick Stats -->
                        <div class="grid grid-cols-4 gap-2 text-center text-xs">
                            <div class="bg-gray-50 rounded p-2">
                                <div class="font-semibold text-gray-800">${(student.uebungsfahrten_ganz || []).filter(Boolean).length}</div>
                                <div class="text-gray-600">Ganze h</div>
                            </div>
                            <div class="bg-gray-50 rounded p-2">
                                <div class="font-semibold text-gray-800">${(student.uebungsfahrten_halb || []).filter(Boolean).length}</div>
                                <div class="text-gray-600">Halbe h</div>
                            </div>
                            <div class="bg-gray-50 rounded p-2">
                                <div class="font-semibold text-gray-800">${(student.ueberlandfahrten || []).filter(Boolean).length}/5</div>
                                <div class="text-gray-600">Ãœberland</div>
                            </div>
                            <div class="bg-gray-50 rounded p-2">
                                <div class="font-semibold text-gray-800">${(student.autobahnfahrten || []).filter(Boolean).length}/4</div>
                                <div class="text-gray-600">Autobahn</div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            html += `
                    </div>
                    
                    <!-- Info Footer -->
                    <div class="mt-8 text-center text-gray-500 text-sm safe-bottom">
                        <p>ğŸ“‹ VollstÃ¤ndiger Ausbildungsbaum implementiert</p>
                        <p>ğŸ”„ Gewichtete Fortschrittsverfolgung: / (25%) â€¢ Ã— (60%) â€¢ âŠ— (100%)</p>
                        <p>ğŸ“± Native iOS-App mit lokaler Speicherung</p>
                    </div>
                </div>
            `;
            
            document.getElementById('main-content').innerHTML = html;
            currentView = 'list';
        }

        // Student Detail rendern
        async function renderStudentDetail(studentId) {
            const student = await StorageManager.getStudentById(studentId);
            if (!student) {
                renderStudentList();
                return;
            }
            
            selectedStudent = student;
            
            let html = `
                <div class="p-4 fade-in safe-top">
                    <!-- Header -->
                    <div class="flex items-center gap-4 mb-6 bg-white rounded-lg shadow-sm p-4">
                        <button onclick="renderStudentList()" class="touch-button p-2 rounded-full hover:bg-gray-100 transition-colors">
                            â† ZurÃ¼ck
                        </button>
                        <div class="flex-1">
                            <h1 class="text-xl font-bold text-gray-800">${student.name} ${student.surname}</h1>
                            <p class="text-gray-600">FahrschÃ¼ler-Details</p>
                        </div>
                        <button onclick="showAlert('Bearbeiten - Feature kommt bald!')" class="touch-button p-2 rounded-full hover:bg-gray-100 transition-colors text-gray-600">
                            âœï¸
                        </button>
                    </div>

                    <!-- Personal Data -->
                    <div class="bg-white rounded-lg shadow-sm p-4 mb-4">
                        <h2 class="text-lg font-semibold text-gray-800 mb-3 flex items-center gap-2">
                            ğŸ‘¤ PersÃ¶nliche Daten
                        </h2>
                        <div class="grid grid-cols-1 gap-3 text-sm text-gray-600">
                            ${student.date_of_birth ? `<div class="flex items-center gap-2">ğŸ“… Geburtsdatum: ${formatGermanDate(student.date_of_birth)}</div>` : ''}
                            ${student.phone ? `<div class="flex items-center gap-2">ğŸ“ Telefon: ${student.phone}</div>` : ''}
                            ${student.address ? `<div class="flex items-center gap-2">ğŸ“ Adresse: ${student.address}</div>` : ''}
                            <div class="flex items-center gap-2">ğŸ“… Ausbildungsbeginn: ${formatGermanDate(student.start_date)}</div>
                            ${student.theory_exam_date ? `<div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full ${student.theory_exam_passed ? 'bg-green-500' : 'bg-yellow-500'}"></div> TheorieprÃ¼fung: ${student.theory_exam_passed ? 'Bestanden' : 'Geplant'} (${formatGermanDate(student.theory_exam_date)})</div>` : ''}
                            ${student.practical_exam_date ? `<div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full ${student.practical_exam_passed ? 'bg-green-500' : 'bg-yellow-500'}"></div> Praktische PrÃ¼fung: ${student.practical_exam_passed ? 'Bestanden' : 'Geplant'} (${formatGermanDate(student.practical_exam_date)})</div>` : ''}
                            ${student.wears_glasses !== null ? `<div class="flex items-center gap-2">ğŸ‘“ BrillentrÃ¤ger: ${student.wears_glasses ? 'Ja' : 'Nein'}</div>` : ''}
                        </div>
                    </div>

                    ${await renderFahrtenSection(student)}
                    ${await renderTrainingProgress(student)}
                </div>
            `;
            
            document.getElementById('main-content').innerHTML = html;
            currentView = 'detail';
        }

        // Fahrten Section rendern
        async function renderFahrtenSection(student) {
            return `
                <div class="bg-white rounded-lg shadow-sm p-4 mb-4">
                    <h2 class="text-lg font-semibold text-gray-800 mb-4">ğŸš— Geleistete Fahrten</h2>
                    
                    ${renderFahrtType(student, 'Ãœberlandfahrten (5 Fahrten)', 'ueberlandfahrten', '#FDE047', false)}
                    ${renderFahrtType(student, 'Autobahnfahrten (4 Fahrten)', 'autobahnfahrten', '#F97316', false)}
                    ${renderFahrtType(student, 'Nachtfahrten (3 Fahrten)', 'nachtfahrten', '#6366F1', false)}
                    ${renderFahrtType(student, 'Ganze Ãœbungsstunden', 'uebungsfahrten_ganz', '#3B82F6', true)}
                    ${renderFahrtType(student, 'Halbe Ãœbungsstunden', 'uebungsfahrten_halb', '#10B981', true)}
                </div>
            `;
        }

        // Einzelner Fahrt-Typ rendern
        function renderFahrtType(student, title, category, color, canAddRemove) {
            const fahrten = student[category] || [];
            const completed = fahrten.filter(Boolean).length;
            const total = fahrten.length;
            const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;
            
            let html = `
                <div class="mb-4">
                    <div class="flex items-center justify-between mb-2">
                        <h3 class="font-medium text-gray-700">${title}</h3>
                        <div class="px-2 py-1 rounded-full text-xs font-medium" style="background-color: ${color}20; color: ${color};">
                            ${percentage}% (${completed}/${total})
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-2 items-center">
            `;
            
            fahrten.forEach((completed, index) => {
                html += `
                    <div class="relative group">
                        <button onclick="toggleFahrt('${student.id}', '${category}', ${index})" 
                                class="touch-button w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium transition-all hover:scale-105 ${
                                    completed 
                                        ? 'bg-green-500 text-white hover:bg-green-600' 
                                        : 'bg-gray-200 text-gray-600 hover:bg-gray-300'
                                }">
                            ${index + 1}
                        </button>
                        ${canAddRemove && fahrten.length > 1 ? `
                            <button onclick="removeFahrt('${student.id}', '${category}', ${index})" 
                                    class="absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white rounded-full text-xs opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600 flex items-center justify-center touch-button">
                                Ã—
                            </button>
                        ` : ''}
                    </div>
                `;
            });
            
            if (canAddRemove) {
                html += `
                    <button onclick="addFahrt('${student.id}', '${category}')" 
                            class="touch-button w-10 h-10 rounded-full text-white hover:scale-105 transition-all flex items-center justify-center font-bold text-lg"
                            style="background-color: ${color};">
                        +
                    </button>
                `;
            }
            
            html += `
                    </div>
                </div>
            `;
            
            return html;
        }

        // Training Progress rendern
        async function renderTrainingProgress(student) {
            let html = `
                <div class="space-y-4 safe-bottom">
                    <h2 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“‹ Ausbildungsfortschritt (Kompletter Baum)</h2>
                    <div class="text-sm text-gray-600 mb-4 p-3 bg-blue-50 rounded-lg">
                        <p><strong>Fortschrittssymbole:</strong> / (25%) â€¢ Ã— (60%) â€¢ âŠ— (100%)</p>
                        <p>ğŸ’¡ Tippen Sie auf die Checkboxen, um den Fortschritt zu Ã¤ndern</p>
                    </div>
            `;
            
            for (const [key, category] of Object.entries(TRAINING_CATEGORIES)) {
                // Fahrerassistenzsysteme aus Situative Bausteine herausfiltern
                if (key === 'situative_bausteine') {
                    html += await renderTrainingCategory(key, category, student, false);
                    // Fahrerassistenzsysteme als separate Kategorie
                    const fahrerassistenz = TRAINING_CATEGORIES.fahrerassistenzsysteme;
                    html += await renderTrainingCategory('fahrerassistenzsysteme', fahrerassistenz, student, true);
                } else if (key !== 'fahrerassistenzsysteme') {
                    html += await renderTrainingCategory(key, category, student, key === 'grundstufe');
                }
            }
            
            html += `</div>`;
            return html;
        }

        // Training Category rendern (mit verschachtelten Sections)
        async function renderTrainingCategory(key, category, student, expanded) {
            const totalItems = countTotalItems(category.sections);
            const progress = await StorageManager.getProgressForStudent(student.id);
            const categoryProgress = progress[key] || {};
            
            // Gewichtete Berechnung fÃ¼r den Fortschritt
            let weightedScore = 0;
            let maxPossible = totalItems * 100;
            
            function calculateSectionProgress(sections, categoryKey) {
                Object.entries(sections).forEach(([sectionKey, section]) => {
                    if (section.sections) {
                        calculateSectionProgress(section.sections, categoryKey);
                    } else if (section.items) {
                        section.items.forEach((item) => {
                            const itemProgress = categoryProgress[sectionKey] && categoryProgress[sectionKey][item];
                            if (itemProgress === 'once') weightedScore += 25;
                            else if (itemProgress === 'twice') weightedScore += 60;
                            else if (itemProgress === 'thrice') weightedScore += 100;
                        });
                    }
                });
            }
            
            calculateSectionProgress(category.sections, key);
            const percentage = maxPossible > 0 ? Math.round((weightedScore / maxPossible) * 100) : 0;
            
            return `
                <div class="bg-white rounded-lg shadow-sm overflow-hidden mb-4">
                    <div class="p-4 ${key} text-white cursor-pointer touch-button" onclick="toggleTrainingSection('${key}')">
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 class="font-semibold">${category.name}</h3>
                                ${category.subtitle ? `<p class="text-sm opacity-90">${category.subtitle}</p>` : ''}
                            </div>
                            <div class="text-right">
                                <div class="text-lg font-bold">${percentage}%</div>
                                <div class="text-xs opacity-90">${totalItems} Items</div>
                            </div>
                        </div>
                        <div class="mt-2 bg-white bg-opacity-20 rounded-full h-2">
                            <div class="bg-white h-2 rounded-full progress-bar" style="width: ${percentage}%"></div>
                        </div>
                    </div>
                    
                    <div id="section-${key}" class="overflow-hidden transition-all duration-300" style="max-height: ${expanded ? '2000px' : '0'};">
                        <div class="p-4 space-y-3">
                            ${await Promise.all(Object.entries(category.sections).map(async ([sectionKey, section]) => 
                                await renderSection(section, sectionKey, 0, key, student.id)
                            )).then(results => results.join(''))}
                        </div>
                    </div>
                </div>
            `;
        }

        // Section rendern (rekursiv fÃ¼r verschachtelte Strukturen)
        async function renderSection(section, sectionKey, level = 0, categoryKey, studentId) {
            if (section.sections) {
                // Hat verschachtelte Sections
                const subSections = await Promise.all(Object.entries(section.sections).map(async ([subKey, subSection]) => 
                    await renderSection(subSection, `${sectionKey}_${subKey}`, level + 1, categoryKey, studentId)
                ));
                
                return `
                    <div class="${level > 0 ? 'ml-4 border-l-2 border-gray-200 pl-4' : 'border-l-4 border-gray-200 pl-3'} mb-4">
                        ${section.name ? `<h4 class="font-medium text-gray-700 mb-2 ${level === 0 ? 'text-base' : 'text-sm'}">${section.name}</h4>` : ''}
                        <div class="space-y-3">
                            ${subSections.join('')}
                        </div>
                    </div>
                `;
            } else {
                // Hat direkte Items
                const progress = await StorageManager.getProgressForStudent(studentId);
                const sectionProgress = progress[categoryKey] && progress[categoryKey][sectionKey] || {};
                
                return `
                    <div class="${level > 0 ? 'ml-4' : 'border-l-4 border-gray-200 pl-3'} mb-3">
                        ${section.name ? `<h4 class="font-medium text-gray-700 mb-2 ${level === 0 ? 'text-base' : 'text-sm'}">${section.name}</h4>` : ''}
                        <div class="space-y-1">
                            ${section.items ? section.items.map(item => {
                                const status = sectionProgress[item] || 'not_started';
                                const symbol = getStatusSymbol(status);
                                const statusClass = getStatusClass(status);
                                
                                return `
                                    <div class="flex items-center gap-2 text-sm">
                                        <div class="w-6 h-6 border border-gray-300 rounded flex items-center justify-center text-sm cursor-pointer hover:scale-110 transition-transform progress-checkbox ${statusClass}" 
                                             onclick="toggleProgressItem('${studentId}', '${categoryKey}', '${sectionKey}', '${item}')">
                                            ${symbol}
                                        </div>
                                        <span class="text-gray-600 flex-1">${item}</span>
                                    </div>
                                `;
                            }).join('') : ''}
                        </div>
                    </div>
                `;
            }
        }

        // ==================== EVENT HANDLERS ====================
        
        function openStudentDetail(studentId) {
            renderStudentDetail(studentId);
        }

        async function toggleFahrt(studentId, category, index) {
            const student = await StorageManager.getStudentById(studentId);
            if (!student) return;
            
            const updatedFahrten = [...student[category]];
            updatedFahrten[index] = !updatedFahrten[index];
            
            const updatedStudent = {
                ...student,
                [category]: updatedFahrten
            };
            
            await StorageManager.updateStudent(updatedStudent);
            renderStudentDetail(studentId);
        }

        async function addFahrt(studentId, category) {
            const student = await StorageManager.getStudentById(studentId);
            if (!student) return;
            
            const updatedFahrten = [...(student[category] || []), false];
            const updatedStudent = {
                ...student,
                [category]: updatedFahrten
            };
            
            await StorageManager.updateStudent(updatedStudent);
            renderStudentDetail(studentId);
        }

        async function removeFahrt(studentId, category, index) {
            const student = await StorageManager.getStudentById(studentId);
            if (!student || (student[category] || []).length <= 1) return;
            
            const updatedFahrten = student[category].filter((_, i) => i !== index);
            const updatedStudent = {
                ...student,
                [category]: updatedFahrten
            };
            
            await StorageManager.updateStudent(updatedStudent);
            renderStudentDetail(studentId);
        }

        function toggleTrainingSection(sectionId) {
            const section = document.getElementById(`section-${sectionId}`);
            const isExpanded = section.style.maxHeight !== '0px';
            section.style.maxHeight = isExpanded ? '0px' : '2000px';
        }

        // Progress Item togglen (mit gewichteten Werten)
        async function toggleProgressItem(studentId, categoryKey, sectionKey, itemKey) {
            const progress = await StorageManager.getProgressForStudent(studentId);
            const currentStatus = progress[categoryKey] && progress[categoryKey][sectionKey] && progress[categoryKey][sectionKey][itemKey] || 'not_started';
            const nextStatus = getNextStatus(currentStatus);
            
            await StorageManager.updateProgressItem(studentId, categoryKey, sectionKey, itemKey, nextStatus);
            
            // Element visuell aktualisieren
            renderStudentDetail(studentId);
        }

        function showAlert(message) {
            alert(message);
        }

        // ==================== APP INITIALIZATION ====================
        
        async function initApp() {
            try {
                // Demo-Daten initialisieren
                await StorageManager.initDemoData();
                
                // Loading Screen ausblenden
                document.getElementById('loading').style.display = 'none';
                document.getElementById('main-content').style.display = 'block';
                
                // Student List anzeigen
                await renderStudentList();
                
                console.log('ğŸš— Deutsche Fahrschul-App geladen!');
                console.log('ğŸ“‹ VollstÃ¤ndiger Ausbildungsbaum verfÃ¼gbar');
                console.log('ğŸ“± Native iOS-App mit Capacitor');
                
                if (CapacitorPreferences) {
                    console.log('âœ… Native Capacitor Preferences aktiv');
                } else {
                    console.log('ğŸ“± Web-Fallback aktiv');
                }
            } catch (error) {
                console.error('Error initializing app:', error);
            }
        }
    </script>
</body>
</html>